{"ast":null,"code":"var _jsxFileName = \"/Users/christosstylidis/Chris/Dev/Code/Education/IHU/Master/Dissertation/Real Time Ticketing System/app/front-end/src/components/AdminDashboard/AdminDashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport endpoints from \"../../api/endpoints\";\nimport CreateTicket from \"../../Shared/CreateTicket\";\nimport io from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst handleLogout = () => {\n  localStorage.clear();\n  window.location.href = \"/\";\n};\nfunction AdminDashboard() {\n  _s();\n  const [tickets, setTickets] = useState([]);\n  const [selectedTicket, setSelectedTicket] = useState(null);\n  const [socket, setSocket] = useState(null);\n  const [username, setUsername] = useState(\"\");\n  useEffect(() => {\n    // Get username\n    const username = localStorage.getItem(\"username\");\n    setUsername(username);\n\n    // Initialize WebSocket connection\n    const socket = io(\"http://localhost:8000\"); // WebSocket server\n    setSocket(socket);\n\n    // Log connection ID when WebSocket connects\n    socket.on(\"connect\", () => {\n      console.log(\"WebSocket connected with ID:\", socket.id);\n    });\n\n    // Listen to \"ticketCreated\" event\n    socket.on(\"ticketCreated\", newTicket => {\n      console.log(\"New ticket received:\", newTicket);\n      setTickets(prevTickets => [newTicket, ...prevTickets]);\n    });\n\n    // Fetch tickets\n    fetchTickets();\n\n    // Cleanup on unmount\n    return () => {\n      socket.disconnect();\n      console.log(\"WebSocket disconnected\");\n    };\n  }, []);\n  const fetchTickets = async () => {\n    try {\n      const token = localStorage.getItem(\"token\");\n      const role = localStorage.getItem(\"role\");\n      const response = await axios.get(endpoints.GET_TICKETS, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Role: role\n        }\n      });\n      setTickets(response.data);\n    } catch (error) {\n      console.error(\"Error fetching tickets:\", error.message);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"dashboardHeader\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"headerLeft\",\n        children: [\"Welcome, \", username || \"[Username]\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"headerCenter\",\n        children: \"Admin Dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"logoutButton\",\n        onClick: handleLogout,\n        children: \"Logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"divider\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"createTicketSection\",\n      children: /*#__PURE__*/_jsxDEV(CreateTicket, {\n        socket: socket\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"divider\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ticketsList\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"sectionHeader\",\n        children: \"Ticket List\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), tickets.length > 0 ? /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"ticketList\",\n        children: tickets.map(ticket => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: ticket.title\n        }, ticket._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No tickets available\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n_s(AdminDashboard, \"XgJT1M49ORHw8R/TzgnprnkueU0=\");\n_c = AdminDashboard;\nexport default AdminDashboard;\nvar _c;\n$RefreshReg$(_c, \"AdminDashboard\");","map":{"version":3,"names":["React","useState","useEffect","axios","endpoints","CreateTicket","io","jsxDEV","_jsxDEV","handleLogout","localStorage","clear","window","location","href","AdminDashboard","_s","tickets","setTickets","selectedTicket","setSelectedTicket","socket","setSocket","username","setUsername","getItem","on","console","log","id","newTicket","prevTickets","fetchTickets","disconnect","token","role","response","get","GET_TICKETS","headers","Authorization","Role","data","error","message","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","length","map","ticket","title","_id","_c","$RefreshReg$"],"sources":["/Users/christosstylidis/Chris/Dev/Code/Education/IHU/Master/Dissertation/Real Time Ticketing System/app/front-end/src/components/AdminDashboard/AdminDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport endpoints from \"../../api/endpoints\";\nimport CreateTicket from \"../../Shared/CreateTicket\";\nimport io from \"socket.io-client\";\n\nconst handleLogout = () => {\n  localStorage.clear();\n  window.location.href = \"/\";\n};\n\nfunction AdminDashboard() {\n  const [tickets, setTickets] = useState([]);\n  const [selectedTicket, setSelectedTicket] = useState(null);\n  const [socket, setSocket] = useState(null);\n  const [username, setUsername] = useState(\"\");\n\n  useEffect(() => {\n    // Get username\n    const username = localStorage.getItem(\"username\");\n    setUsername(username);\n\n    // Initialize WebSocket connection\n    const socket = io(\"http://localhost:8000\"); // WebSocket server\n    setSocket(socket);\n\n    // Log connection ID when WebSocket connects\n    socket.on(\"connect\", () => {\n      console.log(\"WebSocket connected with ID:\", socket.id);\n    });\n\n    // Listen to \"ticketCreated\" event\n    socket.on(\"ticketCreated\", (newTicket) => {\n      console.log(\"New ticket received:\", newTicket);\n      setTickets((prevTickets) => [newTicket, ...prevTickets]);\n    });\n\n    // Fetch tickets\n    fetchTickets();\n\n    // Cleanup on unmount\n    return () => {\n      socket.disconnect();\n      console.log(\"WebSocket disconnected\");\n    };\n  }, []);\n\n  const fetchTickets = async () => {\n    try {\n      const token = localStorage.getItem(\"token\");\n      const role = localStorage.getItem(\"role\");\n\n      const response = await axios.get(endpoints.GET_TICKETS, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Role: role,\n        },\n      });\n      setTickets(response.data);\n    } catch (error) {\n      console.error(\"Error fetching tickets:\", error.message);\n    }\n  };\n\n  return (\n    <div>\n      <header className=\"dashboardHeader\">\n        <div className=\"headerLeft\">Welcome, {username || \"[Username]\"}</div>\n        <h3 className=\"headerCenter\">Admin Dashboard</h3>\n        <button className=\"logoutButton\" onClick={handleLogout}>\n          Logout\n        </button>\n      </header>\n      <hr className=\"divider\" />\n\n      <div className=\"createTicketSection\">\n        <CreateTicket socket={socket} />\n      </div>\n      <hr className=\"divider\" />\n\n      <div className=\"ticketsList\">\n        <h3 className=\"sectionHeader\">Ticket List</h3>\n        {tickets.length > 0 ? (\n          <ul className=\"ticketList\">\n            {tickets.map((ticket) => (\n              <li key={ticket._id}>{ticket.title}</li>\n            ))}\n          </ul>\n        ) : (\n          <p>No tickets available</p>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default AdminDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}